upper_vector<-samp_mean-t_value.2 * samp_sd / sqrt(n)
c(lower_vector[1],upper_vector[1])
plot_ci(lower_vector,upper_vector,mean(area))
t_value.2=qt((1-0.90)/2,df=n-1)
t_value.3=qt((1-0.90)/2,df=n-1)
t_value.3
samp_mean3<-rep(NA,50)
samp_sd3<-rep(NA,50)
n<-60
for(i in 1:50){
samp3<-sample(area,n)
samp_mean3[i]<-mean(samp)
samp_sd3[i]<-sd(samp)
}
t_value.3=qt((1-0.90)/2,df=n-1)
t_value.3
lower_vector3<-samp_mean3+t_value.3 *samp_sd3 /sqrt(n)
upper_vector3<-samp_mean3-t_value.3 * samp_sd3 / sqrt(n)
c(lower_vector3[1],upper_vector3[1])
plot_ci(lower_vector3,upper_vector3,mean(area))
samp_mean3<-rep(NA,50)
samp_sd3<-rep(NA,50)
n<-60
for(i in 1:50){
samp3<-sample(area,n)
samp_mean3[i]<-mean(samp3)
samp_sd3[i]<-sd(samp3)
}
t_value.3=qt((1-0.90)/2,df=n-1)
t_value.3
lower_vector3<-samp_mean3+t_value.3 *samp_sd3 /sqrt(n)
upper_vector3<-samp_mean3-t_value.3 * samp_sd3 / sqrt(n)
c(lower_vector3[1],upper_vector3[1])
plot_ci(lower_vector3,upper_vector3,mean(area))
samp_mean3<-rep(NA,50)
samp_sd3<-rep(NA,50)
n<-60
for(i in 1:50){
samp3<-sample(area,n)
samp_mean3[i]<-mean(samp3)
samp_sd3[i]<-sd(samp3)
}
t_value.3=qt((1-0.90)/2,df=n-1)
t_value.3
lower_vector3<-samp_mean3+t_value.3 *samp_sd3 /sqrt(n)
upper_vector3<-samp_mean3-t_value.3 * samp_sd3 / sqrt(n)
c(lower_vector3[1],upper_vector3[1])
plot_ci(lower_vector3,upper_vector3,mean(area))
samp_mean3<-rep(NA,50)
samp_sd3<-rep(NA,50)
n<-60
for(i in 1:50){
samp3<-sample(area,n)
samp_mean3[i]<-mean(samp3)
samp_sd3[i]<-sd(samp3)
}
t_value.3=qt((1-0.90)/2,df=n-1)
t_value.3
lower_vector3<-samp_mean3+t_value.3 *samp_sd3 /sqrt(n)
upper_vector3<-samp_mean3-t_value.3 * samp_sd3 / sqrt(n)
c(lower_vector3[1],upper_vector3[1])
plot_ci(lower_vector3,upper_vector3,mean(area))
samp_mean3<-rep(NA,50)
samp_sd3<-rep(NA,50)
n<-60
for(i in 1:50){
samp3<-sample(area,n)
samp_mean3[i]<-mean(samp3)
samp_sd3[i]<-sd(samp3)
}
t_value.3=qt((1-0.90)/2,df=n-1)
t_value.3
lower_vector3<-samp_mean3+t_value.3 *samp_sd3 /sqrt(n)
upper_vector3<-samp_mean3-t_value.3 * samp_sd3 / sqrt(n)
c(lower_vector3[1],upper_vector3[1])
plot_ci(lower_vector3,upper_vector3,mean(area))
load(url("http://foxweb.marist.edu/users/duy.nguyen2/nc.RData"))
t.test(nc$gained,mu=30)
nrow(nc)
boxplot(nc$habit, nc$weight)
by(nc$weight, nc$habit, mean)
t.test(nc$gained,mu=30)
t.test(nc$weight,mu=5.5)
load(url("http://foxweb.marist.edu/users/duy.nguyen2/inference.RData"))
inference(y = nc$weight, x = nc$habit, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical")
attach(nc)
t.test(weight~habit)
results=aov(weight~habit,data=nc)
summary(results)
inference(y = nc$weight, x = nc$habit, est = "mean", type = "ci", null = 0, alternative = "twosided", method = "theoretical", order = c("smoker","nonsmoker"))
inference(y=nc$weeks,est="mean", type="ci",null=0,alternative="twosided",method="theoretical")
inference(y=nc$weeks,est="mean", type="ci",null=0,alternative="twosided",method="theoretical",conflevel = 0.9)
inference(y=nc$weeks,est="mean", type="ci",null=0,alternative="twosided",method="theoretical",conflevel = 0.9)
inference(y=nc$weeks,est="mean", type="ci",null=0,alternative="twosided",method="theoretical")
inference(y = nc$weight, x = nc$mature, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical", order=c("young","mature"))
inference(y = nc$weight, x = nc$mature, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical", order=c("not mature","mature"))
head(nc)
inference(y = nc$weight, x = nc$mature, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical", order=c("not mature","mature"))
tail(nc)
tail(nc)
inference(y = nc$weight, x = nc$mature, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical", order=c("younger mom ","mature mom"))
head(nc)
head(nc)
inference(y = nc$weight, x = nc$mature, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical", order=c("younger mom","mature mom"))
inference(y = nc$weight, x = nc$mature, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical", order=c("younger mom","mature mom"))
cor(nc$mage,nc$mature)
boxplot(nc$mage,nc$mature)
plot(nc$mage,nc$mature)
nc$mature1=list("younger mom"==1, "mature mom"==2)
plot(nc$mage,nc$mature)
nc$mature1=list("younger mom"==1, "mature mom"==2)
plot(nc$mage,nc$mature)
plot(nc$mage,nc$mature)
plot(nc$mage,nc$mature)
median((nc$mage))
plot(nc$mage,nc$mature)
mean((nc$mage))
plot(nc$mage,nc$mature)
mean((nc$mage))
plot(nc$mage,nc$mature)
sd((nc$mage))
boxplot(nc$mage)
plot(nc$mage)
plot(nc$mage,nc$mature)
cor(nc$mage,nc$mature)
plot(nc$mage,nc$mature)
nc$mature1
cor(nc$mage,nc$mature)
plot(nc$mage,nc$mature)
inference(y = nc$gained, x = nc$visits, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical")
inference(y = nc$lowbirthweight, x = nc$visits, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical")
inference(y = nc$visits, x = nc$lowbirthweight, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical",order=c("low","now low"))
inference(y = nc$visits, x = nc$lowbirthweight, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical",order=c("low","not low"))
inference(y = nc$visits, x = nc$lowbirthweight, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical",order=c("low","not low"))
inference(y = nc$visits, x = nc$lowbirthweight, est = "mean", type = "ci", null = 0, alternative = "twosided", method = "theoretical", order = c("low","not low"))
inference(y = nc$visits, x = nc$lowbirthweight, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical",order=c("not low","low"))
inference(y = nc$visits, x = nc$lowbirthweight, est = "mean", type = "ci", null = 0, alternative = "twosided", method = "theoretical", order = c("not low"," low"))
inference(y = nc$visits, x = nc$lowbirthweight, est = "mean", type = "ht", null = 0, alternative = "twosided", method = "theoretical",order=c("not low","low"))
inference(y = nc$visits, x = nc$lowbirthweight, est = "mean", type = "ci", null = 0, alternative = "twosided", method = "theoretical", order = c("not low","low"))
library(MASS)
dim(Boston)
names(Boston)
summary(Boston)
dim(Boston)
dim(Boston)
names(Boston)
Boston?
?Boston
?Boston
head(Boston)
plot(medv~lstat)
attach(Boston)
plot(medv~lstat)
abline(plot(medv~lstat))
abline(lm(medv~lstat))
abline(lm(medv~lstat))
abline(lm(medv~lstat))
plot(medv~lstat)
abline(lm(medv~lstat))
attach(Boston)
plot(medv~lstat)
abline(lm(medv~lstat))
summary(lm(medv~lstat))
attach(Boston)
plot(medv~lstat)
abline(lm(medv~lstat))
summary(lm(medv~lstat)) #linear model
plot(residuals(lm(medv~lstat)))
lmB<-lm(medv~lstat)
abline(lmB)
plot(medv~lstat)
lmB<-lm(medv~lstat)
abline(lmB)
plot(residuals(lmB))
plot(lmB$residuals)
plot(lmB$residuals~lmB$fitted.values)
plot(lmB$residuals~lmB$fitted)
hist(lmB$residuals)
var(lmB)
var(lmB$residuals)
plot(medv~crim)
plot(medv~indus)
plot(medv~nox)
plot(medv~chas)
plot(medv~rad)
plot(medv~rm)
plot(medv~age)
plot(medv~ptratio)
plot(medv~black)
plot(medv~zn)
plot(medv~tax)
plot(medv~crim)
plot(medv~indus)
plot(medv~nox)
plot(medv~rm)
plot(medv~age)
par(mfrow(1,2))
mfrow(par(1,2))
par(mfrow(1,2))
par((1,2))
par(1,2)
plot(medv~rm)
plot(medv~age)
cor(medv~age)
cor(medv,age)
cor(medv,rm)
plot(medv~rm)
cor(medv,rm)
lm(medv~rm)
lmR<-lm(medv~rm)
plot(lmR$residuals~lmR$fitted)
qqnorm(lmB$residuals)
qqline(lmB$residuals)
qqnorm(lmB$residuals)
qqline(lmB$residuals)
qqnorm(lmR$residuals)
qqline(lmR$residuals)
summary(lmR)
rm[7]
rm[,7]
load(url("http://foxweb.marist.edu/users/duy.nguyen2/atheism.RData"))
head(athiesm)
head(atheism)
library(MASS)
?Boston
names(Boston)
plot(lstat,medv)
plot(lstat,medv)
attach(Boston)
plot(lstat,medv)
cor(lstat,medv)
summary(plot(lstat,medv))
summary(cor(lstat,medv))
summary(lstat~medv)
summary(plot(lstat,medv)
summary(plot(lstat,medv))
md=lm(lstat,medv)
md=lm(lstat~medv)
plot(md$residuals)
qqnorm(md$residuals)
qqline(md$residuals)
x<-rnorm(1000,mean=0,sd=1)
qqnorm(x)
qqline(x)
load(url("http://foxweb.marist.edu/users/duy.nguyen2/atheism.RData"))
head(atheism)
?atheism
lm.fit<-lm(medv~lstat+age)
plot(lm.fit)
lm.fit<-lm(medv~data=Boston)
lm.fit<-lm(medv.~data=Boston)
lm.fit<-lm(medv~.,data=Boston)
summary(lm.fit)
lm.fit<-lm(medv~,-age,data=Boston)
load(url("http://foxweb.marist.edu/users/duy.nguyen2/inference.RData"))
inference(us12$response, est = "proportion", type = "ci", method = "theoretical", success = "atheist")
us12 <- subset(atheism, nationality == "United States" & year == "2012")
load(url("http://foxweb.marist.edu/users/duy.nguyen2/inference.RData"))
inference(us12$response, est = "proportion", type = "ci", method = "theoretical", success = "atheist")
ad=read.cdv("http://foxweb.marist.edu/users/duy.nguyen2/Advertising.csv",head=TRUE)
ad=read.csv("http://foxweb.marist.edu/users/duy.nguyen2/Advertising.csv",head=TRUE)
names(ad)
lm.fitSR<-lm(sale~radio)
attach(ad)
lm.fitSR<-lm(sale~radio)
lm.fitSR<-lm(sale~radio)
names(ad)
lm.fitSR<-lm(sales~radio)
lm.fitSN<-lm(sales~radio)
lm.fitAll<-lm(sales~.)
lm.fitAll<-lm(sales~., data=ad)
lm.fitMN<-lm(sales~.,-newspaper,data=ad)
summary(lm.fitSR)
summary(lm.fitSN)
summary(lm.fitALL)
summary(lm.fitMN)
summary(lm.fitAll)
plot(lm.fitSR)
plot(lm.fitSN)
plot(lm.fitMN)
lm.fitAll<-lm(sales~., data=ad)
summary(lm.fitAll)
plot(lm.fitAll)
lm.fitMN<-lm(sales~.,-newspaper,data=ad)
summary(lm.fitMN)
plot(lm.fitMN)
lm.STR<-lm(sales~TV+radio+TV*radio)
plot(lm.STR)
lm.fitAll<-lm(sales~., data=ad)
summary(lm.fitAll)
plot(lm.fitAll)
plot(lm.fitMN)
lm.fitMN<-lm(sales~.,-newspaper,data=ad)
summary(lm.fitMN)
plot(lm.fitMN)
lm.fitSN<-lm(sales~radio)
summary(lm.fitSN)
plot(lm.fitSN)
anova(lm.fitAll,lm.fitMN)
aov(lm.fitAll,lm.fitMN)
anova(lm.fitAll,lm.fitMN)
anova(lm.fitAll)
anova(lm.fitMN)
attach(atheism)
spain12<-subset(atheism,nationality=="Spain" & year=="2012")
spain12
spain05<-subset(atheism,nationality=="Spain" & year=="2005")
head(spain05)
inference(spain12$response, est = "proportion", type = "ci", method="theoretical",suc="atheist")
inference(spain05$response, est = "proportion", type = "ci", method="theoretical",suc="atheist")
us12<-subset(atheism,nationality=="United States" & year=="2012")
head(us12)
us05<-subset(atheism,nationality=="United States" & year=="2005")
head(us05)
inference(us12$response, est = "proportion", type = "ci", method="theoretical",suc="atheist")
inference(us05$response, est = "proportion", type = "ci", method="theoretical",suc="atheist")
load(url("http://foxweb.marist.edu/users/duy.nguyen2/atheism.RData"))
head(atheism)
us12 <- subset(atheism, nationality == "United States" & year == "2012")
head(us12)
summary(us12)
proportion=50/(952+50)
proportion
load(url("http://foxweb.marist.edu/users/duy.nguyen2/inference.RData"))
inference(us12$response, est = "proportion", type = "ci", method = "theoretical", success = "atheist")
meUS<- 2 * sqrt(0.0499 * (1 - 0.0499)/1002)
meUS
brazil02 <- subset(atheism, nationality == "Brazil" & year == "2012")
inference(brazil02$response, est = "proportion", type = "ci", method = "theoretical", success = "atheist")
meB <- 2 * sqrt(0.01 * (1 - 0.01/2002))
france02<-subset(atheism, nationality == "France" & year == "2012")
inference(france02$response, est = "proportion", type = "ci", method = "theoretical", success = "atheist")
meF <- 2 * sqrt(0.2873 * (1 - 0.2873)/1688)
n <- 1000
p <- seq(0, 1, 0.01)
me <- 2 * sqrt(p * (1 - p)/n)
plot(me ~ p, ylab = "Margin of Error", xlab = "Population Proportion")
p <- 0.1
n <- 1040
p_hats <- rep(0, 5000)
for(i in 1:5000){
samp <- sample(c("atheist", "non_atheist"), n, replace = TRUE, prob = c(p, 1-p))
p_hats[i] <- sum(samp == "atheist")/n
}
hist(p_hats, main = "p = 0.1, n = 1040", xlim = c(0, 0.18))
mean(p_hats)
p <- 0.1
n <- 400
p_hats <- rep(0, 5000)
for(i in 1:5000){
samp <- sample(c("atheist", "non_atheist"), n, replace = TRUE, prob = c(p, 1-p))
p_hats[i] <- sum(samp == "atheist")/n
}
hist(p_hats, main = "p = 0.1, n = 400", xlim = c(0, 0.18))
p <- 0.02
n <- 1040
p_hats <- rep(0, 5000)
for(i in 1:5000){
samp <- sample(c("atheist", "non_atheist"), n, replace = TRUE, prob = c(p, 1-p))
p_hats[i] <- sum(samp == "atheist")/n
}
hist(p_hats, main = "p = 0.02, n = 1040", xlim = c(0, 0.18))
p <- 0.02
n <- 400
p_hats <- rep(0, 5000)
for(i in 1:5000){
samp <- sample(c("atheist", "non_atheist"), n, replace = TRUE, prob = c(p, 1-p))
p_hats[i] <- sum(samp == "atheist")/n
}
hist(p_hats, main = "p = 0.02, n = 400", xlim = c(0, 0.18))
mean(p_hats)
attach(atheism)
spain12<-subset(atheism,nationality=="Spain" & year=="2012")
spain12
spain05<-subset(atheism,nationality=="Spain" & year=="2005")
head(spain05)
inference(spain12$response, est = "proportion", type = "ci", method="theoretical",suc="atheist")
inference(spain05$response, est = "proportion", type = "ci", method="theoretical",suc="atheist")
us12<-subset(atheism,nationality=="United States" & year=="2012")
head(us12)
us05<-subset(atheism,nationality=="United States" & year=="2005")
head(us05)
inference(us12$response, est = "proportion", type = "ci", method="theoretical",suc="atheist")
inference(us05$response, est = "proportion", type = "ci", method="theoretical",suc="atheist")
p=0.5
z=-1.96
ME=0.01
n=z^2*p*(1-p)/ME^2
n
install.packages("ISLR")
require(ISLR)
summary(ISLR)
library(MASS)
attach(Boston)
lung<-read.csv("http://foxweb.marist.edu/users/duy.nguyen2/LungCapData2.csv",sep=",",header=T)
head(lung)
attach(lung)
plot(Height,LungCap)
#A
lm.fit1<-lm(LungCap~Height)
abline(lm.fit1,col="red",lwd=3)
lm.fit2L<-lm(LungCap~Height+I(Height^2))
summary(lm.fit2L)
lm.fit3L<-lm(LungCap~poly(Height,degree = 3))
summary(lm.fit3L)
lines(smooth.spline(Height,predict(lm.fit2L)),col="red",lwd=3,lty=3)
lines(smooth.spline(Height,predict(lm.fit3L)),col="blue",lwd=3,lty=3)
anova(lm.fit2L,lm.fit3L)
install.packages("ISLR")
require(ISLR)
?Wage
name(Wage)
detach(Boston)
detach(lung)
attach(Wage)
head(Wage)
boxplot(wage~education, col="yellow")
table(education)
mean(wage[education=="1. < HS Grad"],na.rm=T)
mean(wage[education=="2. HS Grad"],na.rm=T)
mean(wage[education=="3. Some College"],na.rm=T)
mean(wage[education=="4. College Grad"],na.rm=T)
mean(wage[education=="5. Advanced Degree"],na.rm=T)
summary(lm(wage~education))
table(education)
class(education)
levels(education)
education=relevel(education,ref="2. HS Grad")
table(education)
#change base reference
education=relevel(education,ref="5. Advanced Degree")
summary(lm(wage~education))
install.packages("ISLR")
wage5=84.10441+11.67894*0 +23.65115*0.40_40.32349*0+66.81336*1
wage5=84.10441+11.67894*0 +23.65115*0.40+40.32349*0+66.81336*1
library("readxl")
library("readx1")
install.packages("readxl")
library("readxl")
library(readxl)
dataset <- read_excel(NULL)
View(dataset)
library(readxl)
LungCapData <- read_excel("~/Desktop/LungCapData.xls")
View(LungCapData)
setwd("~/Desktop")
d<-read_excel("LungCapData.xls")
attach(d)
CutHeight<-cut(Height,breaks=c(0,50,55,50,60,65,70,100))
CutHeight<-cut(Height,breaks=c(0,50,55,60,65,70,100))
CutHeight<-cut(Height,breaks=c(0,50,55,60,65,70,100),labels=c("A","B",'C',"D","E","F"),right=F)
CutHeight[{10}]
CutHeight[1:10]
lmB<-lm(LungCap~CutHeight["B"])
lmB<-lm(LungCap~CutHeight=="B")
summary(lmB)
plot(lmB)
plot(lmB)
summary(lmB)
lmB$coefficients
lmB<-lm(LungCap~CutHeight)
lmB$coefficients
LungCapB=2.148611+1.506029*1+3.248372*05.021941*0+6.543452*0+8.654167*0
LungCapB
lmB<-lm(LungCap~CutHeight)
lmB$coefficients
LungCapB=2.148611+1.506029*1+3.248372*05.021941*0+6.543452*0+8.654167*0
LungCapB
cutAge<-cut(Wage$age,breaks=c(0,21,25,55,65),labels=c("A","B","C","D","E"),right=F)
detach(d)
attach(Wage)
install.packages("ISLR")
require(ISLR)
attach(Wage)
cutAge<-cut(Wage$age,breaks=c(0,21,25,55,65),labels=c("A","B","C","D","E"),right=F)
cutAge<-cut(Wage$age,breaks=c(0,21,25,55,65,100),labels=c("A","B","C","D","E"),right=F)
lm(age~income)$coefficients
lm(age~wage)$coefficients
lm(wage~cutAge)$coefficients
WageA<-62.24350*1+12.59739*0+50.33125*0+55.97578*0+38.55549*0
WageA
cutAge<-cut(Wage$age,breaks=c(0,21,35,55,65,100),labels=c("A","B","C","D","E"),right=F)
lm(wage~cutAge)$coefficients
summary(cutAge)
summary(lm(wage~cutAge)
WageA<-62.24350*1+34.33407*0+54.87416*0+55.97578*0+38.55549*0
WageA
summary(lm(wage~cutAge))
ad=read.csv("http://foxweb.marist.edu/users/duy.nguyen2/Advertising.csv",head=TRUE)
attach(ad)
cor(sales,TV)
plot(TV,sale)
l1<-lm(sales~TV)
summary(l1)
newdata=data.fream(TV=50)
newdata=data.frame(TV=50)
predictt(l1,newdata)
predict(l1,newdata)
p=predict(l1,newdata,interval="confidence")
p
p[1]
newdata=data.frame(TV=c(50,60,70))
p=predictt(l1,newdata,interval="confidence")
newdata=data.frame(TV=c(50,60,70))
p=predict(l1,newdata,interval="confidence")
p
newTV=seq(20,300,by=10)
conf_interval<-predict(l1,newdata=data.frame(TV=newTv),interval="confidence",level=0.9)
abline(l1,col="red",lwd=3)
conf_interval<-predict(l1,newdata=data.frame(TV=newTV),interval="confidence",level=0.9)
abline(l1,col="red",lwd=3)
lines(newTV,conf_interval[,2],col="green",lwd=3,lty=3)
